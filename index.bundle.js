(()=>{"use strict";var e=JSON.parse(localStorage.getItem("users"))||[];0===e.length&&function(e){localStorage.setItem("users",JSON.stringify(e))}(e=[{id:1,name:"Яна",avatar:"https://sun9-44.userapi.com/impg/Fmp3R9zTLJnkrYrJgRPPq8IfQ2tClWKByoHv9w/Lj9oGtVjToE.jpg?size=1080x1440&quality=95&sign=7019cbcdb9a7e615206611f82c34838a&type=album",status:"недавно",lastMessage:"последнее сообщение не очень длинное"},{id:2,name:"Захар",avatar:"https://sun9-76.userapi.com/impg/5v6W30Tm2lroaFXtPZPwO5OlktQMJVyCcElQoQ/7tijVbcubrA.jpg?size=828x828&quality=95&sign=9efdebd108a93b8e9653280f7fdc7c83&type=album",status:"онлайн",lastMessage:"последнее сообщение не очень длинное"},{id:3,name:"Мама",avatar:"https://sun1-27.userapi.com/impg/1_NloAcb3e9eHWuE40CZDT2oBtnwvXBLTzu2vA/kqmti69382o.jpg?size=1080x1399&quality=95&sign=49d0ef831fe99ae2418bcd8b82811342&type=album",status:"2 часа назад",lastMessage:"последнее сообщение не очень длинное"}]);var t=null;document.addEventListener("DOMContentLoaded",(function(){var a=document.querySelector("form"),s=document.querySelector(".form-input"),n=document.querySelector(".messages"),o=document.querySelector(".sendButton"),r=document.querySelector(".icon-button"),c=document.querySelector(".personName"),i=document.querySelector(".personPhoto"),l=document.querySelector(".personStatus"),u={id:"german",name:"Герман",avatar:"https://sun1-24.userapi.com/impg/7rPDGVoAQDvDZ55XLQ8fvqPoXagiitcUTDu4Hg/MiqLb9edxMU.jpg?size=2560x2560&quality=95&sign=b7abba0e9f3dadc571504bdff665cf4f&type=album",status:"онлайн",lastMessage:"последнее сообщение не очень длинное"},d=new URLSearchParams(window.location.search),m=parseInt(d.get("chatId"))-1;function g(e){e.preventDefault();var a=s.value;if(""!==a.trim()){var n={id:Date.now(),text:a,time:(new Date).toLocaleTimeString().slice(0,(new Date).toLocaleTimeString().length-3),self:!0,senderId:t.id};!function(e){var a=JSON.parse(localStorage.getItem("messages_".concat(t.id)))||[];a.push(e),localStorage.setItem("messages_".concat(t.id),JSON.stringify(a))}(n),p(n),s.value="",f()}}function p(e){var a=document.createElement("div");a.classList.add("message",e.self?"message-self":"message-other"),a.setAttribute("data-id",e.id),a.setAttribute("data-self",e.self),a.setAttribute("data-user-id",t.id),a.innerHTML='\n      <p class="message-text">'.concat(e.text,'</p>\n      <p class="message-time">').concat(e.time,"</p>\n    "),n.appendChild(a)}function f(){n.scrollTop=n.scrollHeight}(t=e[m])&&(c.textContent=t.name,i.src=t.avatar,l.textContent=t.status),null!==r&&r.addEventListener("click",(function(){t=t.id===u.id?e[m]:u,c.textContent=t.name,i.src=t.avatar,l.textContent=t.status,function(){for(var e=n.children,t=0;t<e.length;t++){var a=e[t];a.classList.contains("message-self")?a.classList.replace("message-self","message-other"):a.classList.replace("message-other","message-self")}}()})),a&&(a.addEventListener("submit",g),a.addEventListener("keypress",(function(e){13===e.keyCode&&g(e)}))),null!==o&&o.addEventListener("click",g),t&&((JSON.parse(localStorage.getItem("messages_".concat(t.id)))||[]).forEach((function(e){document.querySelector('[data-id="'.concat(e.id,'"]'))||p(e)})),f())}))})();