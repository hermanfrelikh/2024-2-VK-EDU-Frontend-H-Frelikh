(()=>{"use strict";var e=JSON.parse(localStorage.getItem("users"))||[];0===e.length&&function(e){localStorage.setItem("users",JSON.stringify(e))}(e=[{id:1,name:"Яна",avatar:"https://sun9-44.userapi.com/impg/Fmp3R9zTLJnkrYrJgRPPq8IfQ2tClWKByoHv9w/Lj9oGtVjToE.jpg?size=1080x1440&quality=95&sign=7019cbcdb9a7e615206611f82c34838a&type=album",status:"недавно",lastMessage:"последнее сообщение не очень длинное"},{id:2,name:"Захар",avatar:"https://sun9-76.userapi.com/impg/5v6W30Tm2lroaFXtPZPwO5OlktQMJVyCcElQoQ/7tijVbcubrA.jpg?size=828x828&quality=95&sign=9efdebd108a93b8e9653280f7fdc7c83&type=album",status:"онлайн",lastMessage:"последнее сообщение не очень длинное"},{id:3,name:"Мама",avatar:"https://sun1-27.userapi.com/impg/1_NloAcb3e9eHWuE40CZDT2oBtnwvXBLTzu2vA/kqmti69382o.jpg?size=1080x1399&quality=95&sign=49d0ef831fe99ae2418bcd8b82811342&type=album",status:"2 часа назад",lastMessage:"последнее сообщение не очень длинное"}]);var t=null;document.addEventListener("DOMContentLoaded",(function(){var a=document.getElementById("header-container-index");a&&(a.innerHTML='\n    <header class="headerIndex">\n        <div class="headerContainer">\n            <a class="linkMain" href="main.html">\n            <span id="icon" class="material-symbols-outlined icon">arrow_back</span>\n            </a>\n        </div>\n        <div class="headerContainer">\n            <div class="person">\n            <img class="personPhoto" src="" alt="not found" />\n            <div class="personNameStatus">\n                <h1 class="personName"></h1>\n                <p class="personStatus"></p>\n            </div>\n            </div>\n        </div>\n        <div class="headerContainer">\n            <div class="headerIconsRight">\n            <button class="icon-button">\n                <span id="icon" class="material-symbols-outlined icon">sync</span>\n            </button>\n            <span id="icon" class="material-symbols-outlined icon"> search </span>\n            <span id="icon" class="material-symbols-outlined icon"> more_vert </span>\n            </div>\n        </div>\n    </header>\n  ');var n=document.getElementById("form-index");n&&(n.innerHTML='\n    <form class="form" action="/">\n        <input\n          class="form-input"\n          name="message-text"\n          placeholder="Введите сообщение"\n          type="text"\n          autocomplete="off"\n        />\n        <button class="sendButton">Отправить</button>\n    </form>\n  ');var s=document.querySelector("form"),o=document.querySelector(".form-input"),i=document.querySelector(".messages"),c=document.querySelector(".sendButton"),r=document.querySelector(".icon-button"),l=document.querySelector(".personName"),d=document.querySelector(".personPhoto"),m=document.querySelector(".personStatus"),u={id:"german",name:"Герман",avatar:"https://sun1-24.userapi.com/impg/7rPDGVoAQDvDZ55XLQ8fvqPoXagiitcUTDu4Hg/MiqLb9edxMU.jpg?size=2560x2560&quality=95&sign=b7abba0e9f3dadc571504bdff665cf4f&type=album",status:"онлайн",lastMessage:"последнее сообщение не очень длинное"},g=new URLSearchParams(window.location.search),p=parseInt(g.get("chatId"))-1;t=e[p];var f=u;function v(e){e.preventDefault();var a=o.value;if(""!==a.trim()){var n={id:Date.now(),text:a,time:(new Date).toLocaleTimeString().slice(0,(new Date).toLocaleTimeString().length-3),self:!0,senderId:t.id};!function(e){if(t===u){var a=JSON.parse(localStorage.getItem("messages_german_".concat(f.id)))||[];a.push(e),localStorage.setItem("messages_german_".concat(f.id),JSON.stringify(a))}else{var n=JSON.parse(localStorage.getItem("messages_".concat(t.id)))||[];n.push(e),localStorage.setItem("messages_".concat(t.id),JSON.stringify(n))}}(n),S(n),o.value="",y()}}function S(e){var a=document.createElement("div");a.classList.add("message",e.self?"message-self":"message-other"),a.setAttribute("data-id",e.id),a.setAttribute("data-self",e.self),a.setAttribute("data-user-id",t.id),a.innerHTML='\n      <p class="message-text">'.concat(e.text,'</p>\n      <span id="done-all-chat" class="material-symbols-outlined icon">done_all</span>\n      <p class="message-time">').concat(e.time,"</p>\n      \n    "),i.appendChild(a)}function h(){t&&((JSON.parse(localStorage.getItem("messages_".concat(t.id)))||[]).forEach((function(e){document.querySelector('[data-id="'.concat(e.id,'"]'))||S(e)})),(JSON.parse(localStorage.getItem("messages_german_".concat(t.id)))||[]).forEach((function(e){document.querySelector('[data-id="'.concat(e.id,'"]'))||S(e)})),y())}function y(){i.scrollTop=i.scrollHeight}t&&(l.textContent=t.name,d.src=t.avatar,m.textContent=t.status),null!==r&&r.addEventListener("click",(function(){t.id===u.id?(f=t,t=e[p]):(f=t,t=u),l.textContent=t.name,d.src=t.avatar,m.textContent=t.status,function(){for(var e=JSON.parse(localStorage.getItem("messages_".concat(f.id)))||[],t=0;t<e.length;t++)e[t].self=!e[t].self;localStorage.setItem("messages_".concat(f.id),JSON.stringify(e));for(var a=JSON.parse(localStorage.getItem("messages_german_".concat(f.id)))||[],n=0;n<a.length;n++)a[n].self=!a[n].self;localStorage.setItem("messages_german_".concat(f.id),JSON.stringify(a)),h()}()})),s&&(s.addEventListener("submit",v),s.addEventListener("keypress",(function(e){13===e.keyCode&&v(e)}))),null!==c&&c.addEventListener("click",v),h()}))})();