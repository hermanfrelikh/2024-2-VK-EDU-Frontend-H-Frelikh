(()=>{"use strict";function e(e){localStorage.setItem("users",JSON.stringify(e))}var t=JSON.parse(localStorage.getItem("users"))||[];0===t.length&&e(t=[{id:1,name:"Яна",avatar:"https://sun9-44.userapi.com/impg/Fmp3R9zTLJnkrYrJgRPPq8IfQ2tClWKByoHv9w/Lj9oGtVjToE.jpg?size=1080x1440&quality=95&sign=7019cbcdb9a7e615206611f82c34838a&type=album",status:"недавно",lastMessage:"Нет сообщений"},{id:2,name:"Захар",avatar:"https://sun9-76.userapi.com/impg/5v6W30Tm2lroaFXtPZPwO5OlktQMJVyCcElQoQ/7tijVbcubrA.jpg?size=828x828&quality=95&sign=9efdebd108a93b8e9653280f7fdc7c83&type=album",status:"онлайн",lastMessage:"Нет сообщений"},{id:3,name:"Мама",avatar:"https://sun1-27.userapi.com/impg/1_NloAcb3e9eHWuE40CZDT2oBtnwvXBLTzu2vA/kqmti69382o.jpg?size=1080x1399&quality=95&sign=49d0ef831fe99ae2418bcd8b82811342&type=album",status:"2 часа назад",lastMessage:"Нет сообщений"}]);var n=null;document.addEventListener("DOMContentLoaded",(function(){var a=document.getElementById("header-container-index");a&&(a.innerHTML='\n    <header class="headerIndex">\n        <div class="headerContainer">\n            <a class="linkMain" href="main.html">\n            <span id="icon" class="material-symbols-outlined icon">arrow_back</span>\n            </a>\n        </div>\n        <div class="headerContainer">\n            <div class="person">\n            <img class="personPhoto" src="" alt="not found" />\n            <div class="personNameStatus">\n                <h1 class="personName"></h1>\n                <p class="personStatus"></p>\n            </div>\n            </div>\n        </div>\n        <div class="headerContainer">\n            <div class="headerIconsRight">\n            <button class="icon-button">\n                <span id="icon" class="material-symbols-outlined icon">sync</span>\n            </button>\n            <span id="icon" class="material-symbols-outlined icon"> search </span>\n            <span id="icon" class="material-symbols-outlined icon"> more_vert </span>\n            </div>\n        </div>\n    </header>\n  ');var s=document.getElementById("form-index");s&&(s.innerHTML='\n    <form class="form" action="/">\n        <input\n          class="form-input"\n          name="message-text"\n          placeholder="Введите сообщение"\n          type="text"\n          autocomplete="off"\n        />\n        <button class="sendButton">Отправить</button>\n    </form>\n  ');var o=document.querySelector("form"),i=document.querySelector(".form-input"),c=document.querySelector(".messages"),r=document.querySelector(".sendButton"),l=document.querySelector(".icon-button"),d=document.querySelector(".personName"),u=document.querySelector(".personPhoto"),m=document.querySelector(".personStatus"),p={id:"german",name:"Герман",avatar:"https://sun1-24.userapi.com/impg/7rPDGVoAQDvDZ55XLQ8fvqPoXagiitcUTDu4Hg/MiqLb9edxMU.jpg?size=2560x2560&quality=95&sign=b7abba0e9f3dadc571504bdff665cf4f&type=album",status:"онлайн",lastMessage:"Нет сообщений"},g=new URLSearchParams(window.location.search),v=parseInt(g.get("chatId"))-1;n=t[v];var f=p,b=function(e){e&&(d.textContent=e.name,u.src=e.avatar,m.textContent=e.status)};function h(a){a.preventDefault();var s=i.value;if(""!==s.trim()){var o={id:Date.now(),text:s,time:(new Date).toLocaleTimeString().slice(0,(new Date).toLocaleTimeString().length-3),isMainAccountSender:f===p};!function(e){var t=JSON.parse(localStorage.getItem("messages_".concat(v)))||[];t.push(e),localStorage.setItem("messages_".concat(v),JSON.stringify(t))}(o),y(o),i.value="",M(),s.length>50?n.lastMessage=s.slice(0,50)+"...":n.lastMessage=s,e(t)}}function y(e){var t=document.createElement("div");t.classList.add("message",e.isMainAccountSender&&f===p||!e.isMainAccountSender&&f!==p?"message-self":"message-other"),t.setAttribute("data-id",e.id),t.setAttribute("data-self",e.isMainAccountSender&&f===p||!e.isMainAccountSender&&f!==p),t.setAttribute("data-user-id",n.id),t.innerHTML='\n      <div class="message-text-done-all-chat">\n        <p class="message-text">'.concat(e.text,'</p>\n        <span id="done-all-chat" class="material-symbols-outlined icon">done_all</span>\n      </div>\n      \n      <p class="message-time">').concat(e.time,"</p>\n      \n    "),c.appendChild(t)}function S(){c&&(c.innerHTML=""),n&&((JSON.parse(localStorage.getItem("messages_".concat(v)))||[]).forEach((function(e){document.querySelector('[data-id="'.concat(e.id,'"]'))||y(e)})),M())}function M(){c.scrollTop=c.scrollHeight}b(n),null!==l&&l.addEventListener("click",(function(){f=n,n=n===p?t[v]:p,b(n),S()})),o&&(o.addEventListener("submit",h),o.addEventListener("keypress",(function(e){13===e.keyCode&&h(e)}))),null!==r&&r.addEventListener("click",h),S()}))})();